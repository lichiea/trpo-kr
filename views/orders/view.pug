extends ../layout

block content

  // –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–æ–µ –ø–æ–ª–µ
  header.header
    .container
      .header-content
        a.logo(href='/')
          i.fas.fa-spray-can
          span –ö–ª–∏–Ω–∏–Ω–≥–æ–≤–∞—è –∫–æ–º–ø–∞–Ω–∏—è

  .page-container
    .navigation-links
      a.back-link(href='/orders') ‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É –∑–∞–∫–∞–∑–æ–≤
    
    .content-card
      .profile-header
        h1.page-title= title
        .order-status
          span.status-badge(class=order.status.replace(/\s+/g, '-').toLowerCase())= order.status

      if can_view_orders
        .order-actions
          .buttons-container
            button.primary-button#editOrderBtn(type="button")
              i.fas.fa-edit
              span –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–∫–∞–∑
            button.danger-button#deleteOrderBtn(type="button")
              i.fas.fa-trash
              span –£–¥–∞–ª–∏—Ç—å –∑–∞–∫–∞–∑

      // –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–∫–∞–∑–µ
      .order-info-section
        h2.section-title –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–∫–∞–∑–µ
        
        .info-grid
          .info-card
            .info-icon üìã
            .info-content
              h3 –û–±—â–∏–µ –¥–∞–Ω–Ω—ã–µ
              .info-details
                .detail
                  .detail-label ID –∑–∞–∫–∞–∑–∞:
                  .detail-value= order.id
                .detail
                  .detail-label –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:
                  .detail-value= formatDate(order.creationdate)
                .detail
                  .detail-label –ü–ª–∞–Ω–æ–≤–∞—è –¥–∞—Ç–∞:
                  .detail-value= formatDate(order.planneddate)
                .detail
                  .detail-label –û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:
                  .detail-value= order.totalcost ? order.totalcost.toLocaleString('ru-RU') + ' ‚ÇΩ' : '-'
                .detail
                  .detail-label –û–ø–∏—Å–∞–Ω–∏–µ:
                  .detail-value= order.description || '-'
          
          .info-card
            .info-icon üë§
            .info-content
              h3 –ö–ª–∏–µ–Ω—Ç
              .info-details
                .detail
                  .detail-label –§–ò–û:
                  .detail-value= order.client_fio || '-'
                .detail
                  .detail-label –¢–µ–ª–µ—Ñ–æ–Ω:
                  .detail-value= order.client_phone || '-'
                .detail
                  .detail-label Email:
                  .detail-value= order.client_email || '-'
                .detail
                  .detail-label –¢–∏–ø –∫–ª–∏–µ–Ω—Ç–∞:
                  .detail-value= order.client_type || '-'
          
          .info-card
            .info-icon üè¢
            .info-content
              h3 –û–±—ä–µ–∫—Ç —É–±–æ—Ä–∫–∏
              .info-details
                .detail
                  .detail-label –ê–¥—Ä–µ—Å:
                  .detail-value= order.object_address || '-'
                .detail
                  .detail-label –¢–∏–ø –æ–±—ä–µ–∫—Ç–∞:
                  .detail-value= order.object_type || '-'
                .detail
                  .detail-label –ü–ª–æ—â–∞–¥—å:
                  .detail-value= order.object_square ? order.object_square + ' –º¬≤' : '-'
                .detail
                  .detail-label –û–ø–∏—Å–∞–Ω–∏–µ:
                  .detail-value= order.object_description || '-'

      // –£—Å–ª—É–≥–∏ –≤ –∑–∞–∫–∞–∑–µ
      if orderItems && orderItems.length > 0
        .services-section
          h2.section-title –£—Å–ª—É–≥–∏ –≤ –∑–∞–∫–∞–∑–µ
          
          .table-container
            table.data-table
              thead
                tr 
                  th –£—Å–ª—É–≥–∞
                  th –û–ø–∏—Å–∞–Ω–∏–µ
                  th –°—Ç–æ–∏–º–æ—Å—Ç—å (–∑–∞ –º¬≤)
              tbody
                each item in orderItems
                  tr
                    td= item.service_label || '–£—Å–ª—É–≥–∞'
                    td= item.service_description || '-'
                    td= item.item_price ? item.item_price.toLocaleString('ru-RU') + ' ‚ÇΩ' : '0 ‚ÇΩ'
          
          .cost-summary
            .summary-item
              .summary-label –°—É–º–º–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–µ–π —É—Å–ª—É–≥ (–∑–∞ –º¬≤):
              .summary-value= orderItems.reduce((sum, item) => sum + (item.item_price || 0), 0).toLocaleString('ru-RU') + ' ‚ÇΩ'
            .summary-item
              .summary-label –ü–ª–æ—â–∞–¥—å –æ–±—ä–µ–∫—Ç–∞:
              .summary-value= order.object_square ? order.object_square + ' –º¬≤' : '–Ω–µ —É–∫–∞–∑–∞–Ω–∞'
            .summary-item.total
              .summary-label –ò—Ç–æ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ:
              .summary-value= order.totalcost ? order.totalcost.toLocaleString('ru-RU') + ' ‚ÇΩ' : '0 ‚ÇΩ'
      else
        .empty-state
          p –í –∑–∞–∫–∞–∑–µ –Ω–µ—Ç —É—Å–ª—É–≥

    // –î–æ–∫—É–º–µ–Ω—Ç—ã –∑–∞–∫–∞–∑–∞ (–≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞)
    .content-card
      .documents-section
        h2.section-title –î–æ–∫—É–º–µ–Ω—Ç—ã –∑–∞–∫–∞–∑–∞
        
        .documents-header
          h3.section-subtitle –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
          p.section-description –°—Ñ–æ—Ä–º–∏—Ä—É–π—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –¥–ª—è —ç—Ç–æ–≥–æ –∑–∞–∫–∞–∑–∞
        
        .document-actions
          .document-action
            button.primary-button#createWorkOrderBtn
              i.fas.fa-file-contract
              span –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑-–Ω–∞—Ä—è–¥
            p.action-description –î–æ–∫—É–º–µ–Ω—Ç –¥–ª—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –±—Ä–∏–≥–∞–¥—ã –∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
        
          .document-action
            button.primary-button#createServiceActBtn
              i.fas.fa-file-signature
              span –°–æ–∑–¥–∞—Ç—å –∞–∫—Ç –æ–± –æ–∫–∞–∑–∞–Ω–∏–∏ —É—Å–ª—É–≥
            p.action-description –î–æ–∫—É–º–µ–Ω—Ç –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞–±–æ—Ç

      // –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
      if workOrders.length > 0 || serviceActs.length > 0
        .existing-documents
          h3.section-subtitle –°–æ–∑–¥–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
          
          // –ó–∞–∫–∞–∑—ã-–Ω–∞—Ä—è–¥—ã
          if workOrders.length > 0
            .document-category
              h4 –ó–∞–∫–∞–∑—ã-–Ω–∞—Ä—è–¥—ã
              .document-list
                each wo in workOrders
                  .document-item
                    .document-header
                      .document-info
                        .document-title –ó–∞–∫–∞–∑-–Ω–∞—Ä—è–¥ ‚Ññ#{wo.doc.doc_id}
                        .document-date –°–æ–∑–¥–∞–Ω: #{formatDate(wo.doc.doc_creationdate)}
                      .document-status
                        if wo.details.client_sign && wo.details.employee_sign
                          span.status-badge.signed –ü–æ–¥–ø–∏—Å–∞–Ω
                        else if wo.details.client_sign || wo.details.employee_sign
                          span.status-badge.partial –ß–∞—Å—Ç–∏—á–Ω–æ –ø–æ–¥–ø–∏—Å–∞–Ω
                        else
                          span.status-badge.not-signed –ù–µ –ø–æ–¥–ø–∏—Å–∞–Ω
                    
                    .document-details
                      .detail-row
                        .detail-label –ë—Ä–∏–≥–∞–¥–∞:
                        .detail-value
                          if wo.details.team_leader
                            | –ë—Ä–∏–≥–∞–¥–∞ ##{wo.details.id_team} (–ë—Ä–∏–≥–∞–¥–∏—Ä: #{wo.details.team_leader.fio})
                          else
                            | –ë—Ä–∏–≥–∞–¥–∞ ##{wo.details.id_team}
                      
                      if wo.details.team_members && wo.details.team_members.length > 0
                        .detail-row
                          .detail-label –°–æ—Å—Ç–∞–≤ –±—Ä–∏–≥–∞–¥—ã:
                          .detail-value
                            ul.team-members
                              each member in wo.details.team_members
                                li #{member.fio} - #{member.position}
                      
                      .detail-row
                        .detail-label –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç:
                        .detail-value
                          if wo.details.transport_model
                            | #{wo.details.transport_model} (#{wo.details.transport_plate})
                          else
                            | –ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω
                      
                      .signatures
                        .signature-status
                          span.signature-label –ü–æ–¥–ø–∏—Å—å –∫–ª–∏–µ–Ω—Ç–∞:
                          if wo.details.client_sign
                            span.signature-value.signed ‚úì –ü–æ–¥–ø–∏—Å–∞–Ω–æ
                          else
                            span.signature-value.not-signed ‚úó –ù–µ –ø–æ–¥–ø–∏—Å–∞–Ω–æ
                        
                        .signature-status
                          span.signature-label –ü–æ–¥–ø–∏—Å—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞:
                          if wo.details.employee_sign
                            span.signature-value.signed ‚úì –ü–æ–¥–ø–∏—Å–∞–Ω–æ
                          else
                            span.signature-value.not-signed ‚úó –ù–µ –ø–æ–¥–ø–∏—Å–∞–Ω–æ
                    
                    .document-actions-row
                      button.secondary-button.view-document-btn(data-doc-id=wo.doc.doc_id data-type="work-order") –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å
                      if !wo.details.client_sign
                        button.success-button.sign-btn(data-doc-id=wo.doc.doc_id data-signer="client") –ü–æ–¥–ø–∏—Å–∞—Ç—å –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞
                      if !wo.details.employee_sign && can_view_orders
                        button.success-button.sign-btn(data-doc-id=wo.doc.doc_id data-signer="employee") –ü–æ–¥–ø–∏—Å–∞—Ç—å –æ—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
          
          // –ê–∫—Ç—ã –æ–± –æ–∫–∞–∑–∞–Ω–∏–∏ —É—Å–ª—É–≥
          if serviceActs.length > 0
            .document-category
              h4 –ê–∫—Ç—ã –æ–± –æ–∫–∞–∑–∞–Ω–∏–∏ —É—Å–ª—É–≥
              .document-list
                each sa in serviceActs
                  .document-item
                    .document-header
                      .document-info
                        .document-title –ê–∫—Ç –æ–± –æ–∫–∞–∑–∞–Ω–∏–∏ —É—Å–ª—É–≥ ‚Ññ#{sa.doc.doc_id}
                        .document-date –°–æ–∑–¥–∞–Ω: #{formatDate(sa.doc.doc_creationdate)}
                      .document-status
                        if sa.details.client_sign && sa.details.employee_sign
                          span.status-badge.signed –ü–æ–¥–ø–∏—Å–∞–Ω
                        else if sa.details.client_sign || sa.details.employee_sign
                          span.status-badge.partial –ß–∞—Å—Ç–∏—á–Ω–æ –ø–æ–¥–ø–∏—Å–∞–Ω
                        else
                          span.status-badge.not-signed –ù–µ –ø–æ–¥–ø–∏—Å–∞–Ω
                    
                    .document-details
                      if sa.details.comments
                        .detail-row
                          .detail-label –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:
                          .detail-value= sa.details.comments
                      
                      .signatures
                        .signature-status
                          span.signature-label –ü–æ–¥–ø–∏—Å—å –∫–ª–∏–µ–Ω—Ç–∞:
                          if sa.details.client_sign
                            span.signature-value.signed ‚úì –ü–æ–¥–ø–∏—Å–∞–Ω–æ
                          else
                            span.signature-value.not-signed ‚úó –ù–µ –ø–æ–¥–ø–∏—Å–∞–Ω–æ
                        
                        .signature-status
                          span.signature-label –ü–æ–¥–ø–∏—Å—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞:
                          if sa.details.employee_sign
                            span.signature-value.signed ‚úì –ü–æ–¥–ø–∏—Å–∞–Ω–æ
                          else
                            span.signature-value.not-signed ‚úó –ù–µ –ø–æ–¥–ø–∏—Å–∞–Ω–æ
                    
                    .document-actions-row
                      button.secondary-button.view-document-btn(data-doc-id=sa.doc.doc_id data-type="service-act") –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å
                      if !sa.details.client_sign
                        button.success-button.sign-btn(data-doc-id=sa.doc.doc_id data-signer="client") –ü–æ–¥–ø–∏—Å–∞—Ç—å –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞
                      if !sa.details.employee_sign && can_view_orders
                        button.success-button.sign-btn(data-doc-id=sa.doc.doc_id data-signer="employee") –ü–æ–¥–ø–∏—Å–∞—Ç—å –æ—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞

    // –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (–≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞)
    div#createWorkOrderModal.modal-window(style="display:none")
      .modal-content(style="max-width: 600px;")
        .modal-header
          h3 –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞-–Ω–∞—Ä—è–¥–∞
          button.modal-close#closeWorkOrderModal √ó
        .modal-body
          form#workOrderForm
            .form-group
              label(for="workOrderDate") –î–∞—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞ *
              input#workOrderDate(type="date" name="creation_date" required value=new Date().toISOString().split('T')[0])
            
            .form-group
              label(for="workOrderTeam") –ë—Ä–∏–≥–∞–¥–∞
              select#workOrderTeam(name="team_id")
                option(value="") –ù–µ –Ω–∞–∑–Ω–∞—á–∞—Ç—å
                each team in teams
                  option(value=team.id)= team.leader_fio ? `–ë—Ä–∏–≥–∞–¥–∞ #${team.id} (${team.leader_fio} - ${team.leader_position})` : `–ë—Ä–∏–≥–∞–¥–∞ #${team.id}`
            
            .form-group
              label(for="workOrderTransport") –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç
              select#workOrderTransport(name="transport_id")
                option(value="") –ù–µ –Ω–∞–∑–Ω–∞—á–∞—Ç—å
                each transport in transports
                  option(value=transport.id)= transport.model + (transport.registrationnumber ? ` (${transport.registrationnumber})` : '')
            
            .form-note
              p –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –î–æ–∫—É–º–µ–Ω—Ç –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –ø–æ–¥–ø–∏—Å–∞—Ç—å –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è. –ü–æ–¥–ø–∏—Å—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç —Å–æ–≥–ª–∞—Å–∏–µ —Å —É—Å–ª–æ–≤–∏—è–º–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞–±–æ—Ç.
        .modal-footer
          button.secondary-button#cancelWorkOrder –û—Ç–º–µ–Ω–∞
          button.primary-button#submitWorkOrder –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑-–Ω–∞—Ä—è–¥

    div#createServiceActModal.modal-window(style="display:none")
      .modal-content(style="max-width: 600px;")
        .modal-header
          h3 –°–æ–∑–¥–∞–Ω–∏–µ –∞–∫—Ç–∞ –æ–± –æ–∫–∞–∑–∞–Ω–∏–∏ —É—Å–ª—É–≥
          button.modal-close#closeServiceActModal √ó
        .modal-body
          form#serviceActForm
            .form-group
              label(for="serviceActDate") –î–∞—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞ *
              input#serviceActDate(type="date" name="creation_date" required value=new Date().toISOString().split('T')[0])
            
            .form-group
              label(for="serviceActComments") –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
              textarea#serviceActComments(name="comments" rows="4" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º —Ä–∞–±–æ—Ç–∞–º...")
            
            .form-note
              p –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –ê–∫—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç —Ñ–∞–∫—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞–±–æ—Ç. –ü–æ—Å–ª–µ –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è –æ–±–µ–∏–º–∏ —Å—Ç–æ—Ä–æ–Ω–∞–º–∏ —Å—á–∏—Ç–∞–µ—Ç—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–º.
        .modal-footer
          button.secondary-button#cancelServiceAct –û—Ç–º–µ–Ω–∞
          button.primary-button#submitServiceAct –°–æ–∑–¥–∞—Ç—å –∞–∫—Ç

    div#viewDocumentModal.modal-window(style="display:none")
      .modal-content(style="max-width: 800px; max-height: 90vh;")
        .modal-header
          h3#documentModalTitle –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞
          button.modal-close#closeViewDocumentModal √ó
        .modal-body
          #documentContent
            // –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏
        .modal-footer
          button.secondary-button#printDocumentBtn –ü–µ—á–∞—Ç—å
          button.primary-button#closeDocumentBtn –ó–∞–∫—Ä—ã—Ç—å

    // –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞ (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–µ employees)
    #editOrderModal.modal-window(style="display: none;")
      .modal-content
        .modal-header
          h3 –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ ##{order.id}
          button.modal-close#editModalClose √ó
        .modal-body
          form#editOrderForm
            .form-section
              h4 –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
              .form-grid
                .form-group
                  label(for="editStatus") –°—Ç–∞—Ç—É—Å:
                  select#editStatus(name="id_status")
                    each status in statuses
                      option(value=status.status selected=(status.status === order.id_status))= status.status
                
                .form-group
                  label(for="editClient") –ö–ª–∏–µ–Ω—Ç:
                  select#editClient(name="id_client")
                    option(value="") -- –í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∏–µ–Ω—Ç–∞ --
                    // –ö–ª–∏–µ–Ω—Ç—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏
                
                .form-group
                  label(for="editCreationDate") –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:
                  input#editCreationDate(type="date" name="creationdate" value=order.creationdate ? new Date(order.creationdate).toISOString().split('T')[0] : '')
                
                .form-group
                  label(for="editPlannedDate") –ü–ª–∞–Ω–æ–≤–∞—è –¥–∞—Ç–∞:
                  input#editPlannedDate(type="date" name="planneddate" value=order.planneddate ? new Date(order.planneddate).toISOString().split('T')[0] : '')
                
                .form-group
                  label(for="editTotalCost") –û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:
                  input#editTotalCost(type="number" name="totalcost" value=order.totalcost || 0 readonly)
                
                .form-group.full-width
                  label(for="editDescription") –û–ø–∏—Å–∞–Ω–∏–µ:
                  textarea#editDescription(name="description" rows="3")= order.description || ''
            
            .form-section
              h4 –£—Å–ª—É–≥–∏ –≤ –∑–∞–∫–∞–∑–µ
              #servicesContainer
                // –£—Å–ª—É–≥–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏
              
              .form-actions
                button.secondary-button(type="button" onclick="addService()") + –î–æ–±–∞–≤–∏—Ç—å —É—Å–ª—É–≥—É
        
        .modal-footer
          button.secondary-button#cancelEdit –û—Ç–º–µ–Ω–∞
          button.primary-button#saveEdit –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è

    // –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–µ employees)
    #deleteConfirmModal.modal-window(style="display: none;")
      .modal-content
        .modal-header
          h3 –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è
          button.modal-close#deleteModalClose √ó
        .modal-body
          .warning-message
            .warning-icon ‚ö†Ô∏è
            .warning-text
              h4 –í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∑–∞–∫–∞–∑?
              p
                strong –ó–∞–∫–∞–∑ ##{order.id} –¥–ª—è #{order.client_fio}
              p –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å. –í—Å–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑–∞ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ.
        .modal-footer
          button.secondary-button#cancelDelete –û—Ç–º–µ–Ω–∞
          button.danger-button#confirmDelete –£–¥–∞–ª–∏—Ç—å

  script.
    document.addEventListener('DOMContentLoaded', function() {
      // ============ –ü–ï–†–ï–ú–ï–ù–ù–´–ï ============
      const orderId = #{order.id};
      let clientsList = [];
      let servicesList = [];
      let currentServices = [];
      
      // –≠–ª–µ–º–µ–Ω—Ç—ã —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
      const editOrderBtn = document.getElementById('editOrderBtn');
      const editOrderModal = document.getElementById('editOrderModal');
      const editModalClose = document.getElementById('editModalClose');
      const cancelEditBtn = document.getElementById('cancelEdit');
      const saveEditBtn = document.getElementById('saveEdit');
      const editForm = document.getElementById('editOrderForm');
      
      // –≠–ª–µ–º–µ–Ω—Ç—ã —É–¥–∞–ª–µ–Ω–∏—è
      const deleteOrderBtn = document.getElementById('deleteOrderBtn');
      const deleteModal = document.getElementById('deleteConfirmModal');
      const deleteModalClose = document.getElementById('deleteModalClose');
      const cancelDeleteBtn = document.getElementById('cancelDelete');
      const confirmDeleteBtn = document.getElementById('confirmDelete');
      
      // –≠–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
      const createWorkOrderBtn = document.getElementById('createWorkOrderBtn');
      const createServiceActBtn = document.getElementById('createServiceActBtn');
      const createWorkOrderModal = document.getElementById('createWorkOrderModal');
      const createServiceActModal = document.getElementById('createServiceActModal');
      const viewDocumentModal = document.getElementById('viewDocumentModal');
      const closeWorkOrderModal = document.getElementById('closeWorkOrderModal');
      const closeServiceActModal = document.getElementById('closeServiceActModal');
      const cancelWorkOrder = document.getElementById('cancelWorkOrder');
      const cancelServiceAct = document.getElementById('cancelServiceAct');
      const submitWorkOrder = document.getElementById('submitWorkOrder');
      const submitServiceAct = document.getElementById('submitServiceAct');
      
      // ============ –§–£–ù–ö–¶–ò–ò ============
      
      // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
      function closeModal(modal) {
        if (modal) {
          modal.style.display = 'none';
          document.body.style.overflow = 'auto';
        }
      }
      
      // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
      function openModal(modal) {
        if (modal) {
          modal.style.display = 'flex';
          document.body.style.overflow = 'hidden';
        }
      }
      
      // –ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
      function toggleButtonLoading(button, isLoading, loadingText = '–ó–∞–≥—Ä—É–∑–∫–∞...') {
        if (isLoading) {
          button.disabled = true;
          const spinner = '<span class="loading-spinner"></span>';
          button.innerHTML = spinner + loadingText;
        } else {
          button.disabled = false;
          button.innerHTML = button.dataset.originalText || button.textContent;
        }
      }
      
      // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
      async function loadEditData() {
        try {
          const response = await fetch(`/orders/${orderId}/edit-data`);
          const data = await response.json();
          
          if (data.error) {
            throw new Error(data.error);
          }
          
          // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–ø–∏—Å–∫–∏
          clientsList = data.clients || [];
          servicesList = data.allServices || [];
          currentServices = data.services || [];
          
          // –ó–∞–ø–æ–ª–Ω—è–µ–º –∫–ª–∏–µ–Ω—Ç–æ–≤
          const clientSelect = document.getElementById('editClient');
          clientSelect.innerHTML = '<option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∏–µ–Ω—Ç–∞ --</option>';
          
          clientsList.forEach(client => {
            const option = document.createElement('option');
            option.value = client.id;
            option.textContent = client.fio;
            option.selected = client.id == data.order.id_client;
            clientSelect.appendChild(option);
          });
          
          // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —É—Å–ª—É–≥–∏
          renderServices(currentServices);
          
        } catch (error) {
          console.error('Error loading edit data:', error);
          alert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö: ' + error.message);
        }
      }
      
      // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—Å–ª—É–≥ –≤ —Ñ–æ—Ä–º–µ
      function renderServices(services) {
        const container = document.getElementById('servicesContainer');
        container.innerHTML = '';
        
        services.forEach((service, index) => {
          const serviceDiv = document.createElement('div');
          serviceDiv.className = 'service-item';
          serviceDiv.innerHTML = `
            <div class="service-row">
              <div class="form-group">
                <label>–£—Å–ª—É–≥–∞:</label>
                <select name="services[${index}][id]" class="service-select" onchange="updateServicePrice(this)">
                  <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É --</option>
                  ${servicesList.map(s => 
                    `<option value="${s.id}" ${s.id == service.id_serv ? 'selected' : ''}>${s.label}</option>`
                  ).join('')}
                </select>
              </div>
              <div class="form-group">
                <label>–¶–µ–Ω–∞:</label>
                <input type="number" name="services[${index}][price]" value="${service.price || 0}" 
                       class="service-price" onchange="calculateTotal()">
              </div>
              <button type="button" class="danger-button small" onclick="removeService(${index})">√ó</button>
            </div>
          `;
          container.appendChild(serviceDiv);
        });
        
        calculateTotal();
      }
      
      // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π —É—Å–ª—É–≥–∏
      window.addService = function() {
        const container = document.getElementById('servicesContainer');
        const index = container.children.length;
        
        const serviceDiv = document.createElement('div');
        serviceDiv.className = 'service-item';
        serviceDiv.innerHTML = `
          <div class="service-row">
            <div class="form-group">
              <label>–£—Å–ª—É–≥–∞:</label>
              <select name="services[${index}][id]" class="service-select" onchange="updateServicePrice(this)">
                <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É --</option>
                ${servicesList.map(s => 
                  `<option value="${s.id}">${s.label}</option>`
                ).join('')}
              </select>
            </div>
            <div class="form-group">
              <label>–¶–µ–Ω–∞:</label>
              <input type="number" name="services[${index}][price]" value="0" 
                     class="service-price" onchange="calculateTotal()">
            </div>
            <button type="button" class="danger-button small" onclick="removeService(${index})">√ó</button>
          </div>
        `;
        container.appendChild(serviceDiv);
      }
      
      // –£–¥–∞–ª–µ–Ω–∏–µ —É—Å–ª—É–≥–∏
      window.removeService = function(index) {
        if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É —É—Å–ª—É–≥—É –∏–∑ –∑–∞–∫–∞–∑–∞?')) {
          const container = document.getElementById('servicesContainer');
          const serviceItem = container.querySelector(`.service-item:nth-child(${index + 1})`);
          if (serviceItem) {
            serviceItem.remove();
            calculateTotal();
          }
        }
      }
      
      // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω—ã —É—Å–ª—É–≥–∏ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ
      window.updateServicePrice = async function(select) {
        const serviceId = select.value;
        const priceInput = select.closest('.service-row').querySelector('.service-price');
        
        if (serviceId) {
          try {
            const response = await fetch(`/orders/services/${serviceId}/price`);
            const data = await response.json();
            
            if (data.price) {
              priceInput.value = data.price;
              calculateTotal();
            }
          } catch (error) {
            console.error('Error loading service price:', error);
          }
        }
      }
      
      // –†–∞—Å—á–µ—Ç –æ–±—â–µ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏
      window.calculateTotal = function() {
        const priceInputs = document.querySelectorAll('.service-price');
        let total = 0;
        
        priceInputs.forEach(input => {
          total += parseFloat(input.value) || 0;
        });
        
        // –£–º–Ω–æ–∂–∞–µ–º –Ω–∞ –ø–ª–æ—â–∞–¥—å (–µ—Å–ª–∏ –µ—Å—Ç—å)
        const objectSquare = #{order.object_square} || 0;
        if (objectSquare > 0) {
          total = total * objectSquare;
        }
        
        document.getElementById('editTotalCost').value = total;
      }
      
      // ============ –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–Ø ============
      
      // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
      if (editOrderBtn) {
        editOrderBtn.addEventListener('click', async function() {
          await loadEditData();
          openModal(editOrderModal);
        });
      }
      
      // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
      if (editModalClose) {
        editModalClose.addEventListener('click', () => closeModal(editOrderModal));
      }
      
      if (cancelEditBtn) {
        cancelEditBtn.addEventListener('click', () => closeModal(editOrderModal));
      }
      
      // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π - –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –í–ï–†–°–ò–Ø
      if (saveEditBtn) {
        saveEditBtn.addEventListener('click', async function() {
          // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–æ—Ä–º—ã
          const formData = {
            order: {
              id_status: document.getElementById('editStatus').value,
              id_client: document.getElementById('editClient').value,
              creationdate: document.getElementById('editCreationDate').value,
              planneddate: document.getElementById('editPlannedDate').value || null,
              totalcost: parseFloat(document.getElementById('editTotalCost').value) || 0,
              description: document.getElementById('editDescription').value.trim()
            },
            services: []
          };
          
          // –°–æ–±–∏—Ä–∞–µ–º —É—Å–ª—É–≥–∏ - –í–ê–ñ–ù–û: –µ—Å–ª–∏ –Ω–µ—Ç —É—Å–ª—É–≥, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤
          const serviceItems = document.querySelectorAll('.service-item');
          serviceItems.forEach((item, index) => {
            const serviceId = item.querySelector(`[name="services[${index}][id]"]`).value;
            const price = item.querySelector(`[name="services[${index}][price]"]`).value;
            
            if (serviceId && price) {
              formData.services.push({
                id: parseInt(serviceId),
                price: parseFloat(price)
              });
            }
          });
          
          // –í–∞–ª–∏–¥–∞—Ü–∏—è - —Ç–æ–ª—å–∫–æ –∫–ª–∏–µ–Ω—Ç –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω
          if (!formData.order.id_client) {
            alert('–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∏–µ–Ω—Ç–∞');
            return;
          }
          
          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
          toggleButtonLoading(saveEditBtn, true, '–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...');
          
          try {
            const response = await fetch(`/orders/update/${orderId}`, {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify(formData)
            });
            
            const data = await response.json();
            
            if (data.success) {
              alert('–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω');
              closeModal(editOrderModal);
              location.reload();
            } else {
              alert('–û—à–∏–±–∫–∞: ' + (data.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'));
            }
            
          } catch (error) {
            console.error('Error:', error);
            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞');
          } finally {
            toggleButtonLoading(saveEditBtn, false);
          }
        });
      }
      
      // ============ –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –£–î–ê–õ–ï–ù–ò–Ø ============
      
      // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —É–¥–∞–ª–µ–Ω–∏—è
      if (deleteOrderBtn) {
        deleteOrderBtn.addEventListener('click', () => openModal(deleteModal));
      }
      
      // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —É–¥–∞–ª–µ–Ω–∏—è
      if (deleteModalClose) {
        deleteModalClose.addEventListener('click', () => closeModal(deleteModal));
      }
      
      if (cancelDeleteBtn) {
        cancelDeleteBtn.addEventListener('click', () => closeModal(deleteModal));
      }
      
      // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è
      if (confirmDeleteBtn) {
        confirmDeleteBtn.addEventListener('click', async function() {
          toggleButtonLoading(confirmDeleteBtn, true, '–£–¥–∞–ª–µ–Ω–∏–µ...');
          
          try {
            const response = await fetch(`/orders/delete/${orderId}`, {
              method: 'DELETE',
              headers: {
                'Content-Type': 'application/json',
              }
            });
            
            const data = await response.json();
            
            if (data.success) {
              alert('–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω');
              window.location.href = '/orders';
            } else {
              alert('–û—à–∏–±–∫–∞: ' + (data.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'));
              closeModal(deleteModal);
            }
            
          } catch (error) {
            console.error('Error:', error);
            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞');
          } finally {
            toggleButtonLoading(confirmDeleteBtn, false);
          }
        });
      }
      
      // ============ –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –î–û–ö–£–ú–ï–ù–¢–û–í ============
      
      // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
      if (createWorkOrderBtn) {
        createWorkOrderBtn.addEventListener('click', () => openModal(createWorkOrderModal));
      }
      
      if (createServiceActBtn) {
        createServiceActBtn.addEventListener('click', () => openModal(createServiceActModal));
      }
      
      // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
      if (closeWorkOrderModal) {
        closeWorkOrderModal.addEventListener('click', () => closeModal(createWorkOrderModal));
      }
      
      if (closeServiceActModal) {
        closeServiceActModal.addEventListener('click', () => closeModal(createServiceActModal));
      }
      
      if (cancelWorkOrder) {
        cancelWorkOrder.addEventListener('click', () => closeModal(createWorkOrderModal));
      }
      
      if (cancelServiceAct) {
        cancelServiceAct.addEventListener('click', () => closeModal(createServiceActModal));
      }
      
      // –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞-–Ω–∞—Ä—è–¥–∞
      if (submitWorkOrder) {
        submitWorkOrder.addEventListener('click', async function() {
          const formData = new FormData(document.getElementById('workOrderForm'));
          const data = Object.fromEntries(formData.entries());
          
          const submitBtn = this;
          toggleButtonLoading(submitBtn, true, '–°–æ–∑–¥–∞–Ω–∏–µ...');
          
          try {
            const response = await fetch(`/orders/${orderId}/documents/work-order`, {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify(data)
            });
            
            const result = await response.json();
            
            if (result.success) {
              alert(result.message);
              closeModal(createWorkOrderModal);
              location.reload();
            } else {
              alert('–û—à–∏–±–∫–∞: ' + result.error);
            }
            
          } catch (error) {
            console.error('Error:', error);
            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞');
          } finally {
            toggleButtonLoading(submitBtn, false);
          }
        });
      }
      
      // –°–æ–∑–¥–∞–Ω–∏–µ –∞–∫—Ç–∞ –æ–± –æ–∫–∞–∑–∞–Ω–∏–∏ —É—Å–ª—É–≥
      if (submitServiceAct) {
        submitServiceAct.addEventListener('click', async function() {
          const formData = new FormData(document.getElementById('serviceActForm'));
          const data = Object.fromEntries(formData.entries());
          
          const submitBtn = this;
          toggleButtonLoading(submitBtn, true, '–°–æ–∑–¥–∞–Ω–∏–µ...');
          
          try {
            const response = await fetch(`/orders/${orderId}/documents/service-act`, {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify(data)
            });
            
            const result = await response.json();
            
            if (result.success) {
              alert(result.message);
              closeModal(createServiceActModal);
              location.reload();
            } else {
              alert('–û—à–∏–±–∫–∞: ' + result.error);
            }
            
          } catch (error) {
            console.error('Error:', error);
            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞');
          } finally {
            toggleButtonLoading(submitBtn, false);
          }
        });
      }
      
      // –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞
      document.querySelectorAll('.view-document-btn').forEach(btn => {
        btn.addEventListener('click', async function() {
          const docId = this.dataset.docId;
          const docType = this.dataset.type;
          
          try {
            const response = await fetch(`/orders/${orderId}/documents/${docId}/view`);
            if (!response.ok) {
              throw new Error('–î–æ–∫—É–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω');
            }
            
            const docContent = await response.text();
            
            document.getElementById('documentModalTitle').textContent = 
              docType === 'work-order' ? '–ó–∞–∫–∞–∑-–Ω–∞—Ä—è–¥' : '–ê–∫—Ç –æ–± –æ–∫–∞–∑–∞–Ω–∏–∏ —É—Å–ª—É–≥';
            document.getElementById('documentContent').innerHTML = docContent;
            openModal(viewDocumentModal);
            
          } catch (error) {
            console.error('Error loading document:', error);
            alert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞');
          }
        });
      });
      
      // –ü–æ–¥–ø–∏—Å–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
      document.querySelectorAll('.sign-btn').forEach(btn => {
        btn.addEventListener('click', async function() {
          const docId = this.dataset.docId;
          const signer = this.dataset.signer;
          
          if (!confirm(`–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–æ–¥–ø–∏—Å–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –æ—Ç –∏–º–µ–Ω–∏ ${signer === 'client' ? '–∫–ª–∏–µ–Ω—Ç–∞' : '—Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞'}`)) {
            return;
          }
          
          try {
            const response = await fetch(`/orders/documents/${docId}/sign/${signer}`, {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
              }
            });
            
            const result = await response.json();
            
            if (result.success) {
              alert(result.message);
              location.reload();
            } else {
              alert('–û—à–∏–±–∫–∞: ' + result.error);
            }
          } catch (error) {
            console.error('Error signing document:', error);
            alert('–û—à–∏–±–∫–∞ –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞');
          }
        });
      });
      
      // –§—É–Ω–∫—Ü–∏—è –ø–µ—á–∞—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞
      document.getElementById('printDocumentBtn')?.addEventListener('click', function() {
        const printContent = document.getElementById('documentContent').innerHTML;
        const originalContent = document.body.innerHTML;
        
        document.body.innerHTML = printContent;
        window.print();
        document.body.innerHTML = originalContent;
        location.reload();
      });
      
      // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
      document.getElementById('closeDocumentBtn')?.addEventListener('click', () => closeModal(viewDocumentModal));
      
      // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –æ–∫–Ω–∞
      document.querySelectorAll('.modal-window').forEach(modal => {
        modal.addEventListener('click', function(event) {
          if (event.target === modal) {
            closeModal(modal);
          }
        });
      });
      
      // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ ESC
      document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
          document.querySelectorAll('.modal-window').forEach(modal => closeModal(modal));
        }
      });
      
      // –°—Ç–∏–ª—å –¥–ª—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –∑–∞–≥—Ä—É–∑–∫–∏
      const style = document.createElement('style');
      style.textContent = `
        .service-row {
          display: flex;
          gap: 10px;
          align-items: flex-end;
          margin-bottom: 10px;
        }
        
        .service-row .form-group {
          flex: 1;
          margin-bottom: 0;
        }
        
        .small {
          padding: 5px 10px;
          font-size: 14px;
        }
        
        .loading-spinner {
          display: inline-block;
          width: 16px;
          height: 16px;
          border: 2px solid rgba(255,255,255,.3);
          border-radius: 50%;
          border-top-color: #fff;
          animation: spin 1s ease-in-out infinite;
          margin-right: 8px;
          vertical-align: middle;
        }
        
        @keyframes spin {
          to { transform: rotate(360deg); }
        }
        
        .full-width {
          grid-column: 1 / -1;
        }
      `;
      document.head.appendChild(style);
    });


  style.
    /* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ */
    .page-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 30px 20px;
    }

    .status-badge {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 500;
    }

    .status-badge.–Ω–æ–≤—ã–π { background-color: #e3f2fd; color: #1976d2; }
    .status-badge.–æ–±—Ä–∞–±–æ—Ç–∫–∞-–∑–∞–∫–∞–∑–∞-–º–µ–Ω–µ–¥–∂–µ—Ä–æ–º { background-color: #fff3e0; color: #f57c00; }
    .status-badge.–Ω–∞-—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏-–∑–Ω { background-color: #f3e5f5; color: #7b1fa2; }
    .status-badge.–≤-–æ–∂–∏–¥–∞–Ω–∏–∏ { background-color: #fff3e0; color: #f57c00; }
    .status-badge.–∑–∞–∫–∞–∑-–≤-—Ä–∞–±–æ—Ç–µ { background-color: #e8f5e8; color: #388e3c; }
    .status-badge.–∑–∞–∫–∞–∑-–≤—ã–ø–æ–ª–Ω–µ–Ω { background-color: #e8f5e8; color: #388e3c; }
    .status-badge.–Ω–∞-—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏-–∞–∫—Ç–∞ { background-color: #fff3e0; color: #f57c00; }
    .status-badge.–∞–∫—Ç-—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω { background-color: #e8f5e8; color: #388e3c; }
    .status-badge.–∞–∫—Ç-–Ω–µ-—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω { background-color: #ffebee; color: #d32f2f; }
    .status-badge.–≤—ã—Å—Ç–∞–≤–ª–µ–Ω-—Å—á–µ—Ç-–Ω–∞-–æ–ø–ª–∞—Ç—É { background-color: #fff3e0; color: #f57c00; }
    .status-badge.–∑–∞–∫–∞–∑-–æ–ø–ª–∞—á–µ–Ω { background-color: #e8f5e8; color: #388e3c; }
    .status-badge.–∑–∞–≤–µ—Ä—à—ë–Ω { background-color: #f5f5f5; color: #616161; }

    .description-cell {
      max-width: 200px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .form-group.full-width {
      grid-column: 1 / -1;
    }
        
    .content-card {
      background: #FFFFFF;
      border-radius: 12px;
      padding: 40px;
      box-shadow: 0 4px 20px rgba(92, 78, 174, 0.1);
    }
    
    .page-title {
      font-size: 32px;
      color: #5C4EAE;
      margin: 0;
      font-weight: 600;
    }
    
    /* –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Å—ã–ª–∫–∏ */
    .navigation-links {
      display: flex;
      justify-content: space-between;
      margin-bottom: 25px;
    }
    
    .back-link, .home-link {
      color: #6C5FBC;
      text-decoration: none;
      font-size: 16px;
      font-weight: 500;
      transition: color 0.3s ease;
    }
    
    .back-link:hover, .home-link:hover {
      color: #5C4EAE;
      text-decoration: underline;
    }
    
    /* –®–∞–ø–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è */
    .profile-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 40px;
      padding-bottom: 25px;
      border-bottom: 2px solid #EAEAEA;
    }
    
    /* –°–µ–∫—Ü–∏–∏ */
    .section-title {
      font-size: 24px;
      color: #5C4EAE;
      margin-bottom: 25px;
      font-weight: 600;
    }
    
    .form-section, .info-section {
      margin-bottom: 40px;
    }
    
    /* –§–æ—Ä–º–∞ */
    .profile-form {
      margin-bottom: 40px;
    }
    
    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      gap: 25px;
    }
    
    .form-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .form-group label {
      font-weight: 600;
      color: #333;
      font-size: 16px;
    }
    
    .form-group input {
      padding: 14px 16px;
      border: 2px solid #EAEAEA;
      border-radius: 8px;
      font-size: 16px;
      background: #FFFFFF;
      transition: all 0.3s ease;
    }
    
    .form-group input:focus {
      outline: none;
      border-color: #6C5FBC;
      box-shadow: 0 0 0 3px rgba(108, 95, 188, 0.1);
    }
    
    .form-group input:disabled {
      background-color: #F8F8F8;
      color: #666;
      cursor: not-allowed;
    }
    
    .form-value {
      padding: 14px 0;
      font-size: 16px;
      color: #333;
      border-bottom: 1px solid #EAEAEA;
    }
    
    .form-actions {
      margin-top: 30px;
      padding-top: 25px;
      border-top: 2px solid #EAEAEA;
    }
    
    .buttons-row {
      display: flex;
      gap: 20px;
      justify-content: flex-start;
      align-items: center;
      flex-wrap: wrap;
    }

    /* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ */
    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
    }
    
    .info-item {
      display: flex;
      flex-direction: column;
      gap: 6px;
      padding: 15px;
      background: #F8F8F8;
      border-radius: 8px;
      border-left: 4px solid #6C5FBC;
    }
    
    .info-label {
      font-weight: 600;
      color: #5C4EAE;
      font-size: 14px;
    }
    
    .info-value {
      color: #333;
      font-size: 16px;
    }
    
    /* –ö–∞—Ä—Ç–æ—á–∫–∏ –±—Ä–∏–≥–∞–¥—ã */
    .info-card {
      background: #FFFFFF;
      border-radius: 12px;
      padding: 25px;
      border: 2px solid #EAEAEA;
      display: flex;
      align-items: flex-start;
      gap: 20px;
    }
    
    .team-leader-card {
      border-color: #FFD700;
      background: linear-gradient(135deg, #FFF9E6 0%, #FFF0B3 100%);
    }
    
    .team-member-card {
      border-color: #6C5FBC;
      background: linear-gradient(135deg, #F5F3FF 0%, #E6E1FF 100%);
    }

    .form-group select{
      padding: 14px 16px;
      border: 2px solid #EAEAEA;
      border-radius: 8px;
      font-size: 16px;
      max-width: 520px;
      background: #FFFFFF;
      transition: all 0.3s ease;
    }
    
    .form-group select:focus {
      outline: none;
      border-color: #6C5FBC;
      box-shadow: 0 0 0 3px rgba(108, 95, 188, 0.1);
    }
    
    .form-group select:disabled {
      background-color: #F8F8F8;
      color: #666;
      cursor: not-allowed;
    }  
    
    .info-icon {
      font-size: 32px;
      background: white;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    
    .info-content {
      flex: 1;
    }
    
    .info-card h3 {
      font-size: 20px;
      color: #5C4EAE;
      margin: 0 0 15px 0;
      font-weight: 600;
    }
    
    .info-details {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    
    .detail {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .detail-label {
      font-weight: 600;
      color: #666;
      font-size: 15px;
      min-width: 120px;
    }
    
    .detail-value {
      color: #333;
      font-size: 16px;
      font-weight: 500;
    }
    
    /* –°–æ–æ–±—â–µ–Ω–∏—è */
    .empty-message {
      text-align: center;
      padding: 40px 20px;
      color: #666;
      font-size: 18px;
      font-style: italic;
      background: #F8F8F8;
      border-radius: 8px;
      border: 1px dashed #DDD;
    }
    
    /* –ö–Ω–æ–ø–∫–∏ */
    .primary-button {
      background-color: #6C5FBC;
      color: white;
      padding: 14px 32px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 500;
      transition: all 0.3s ease;
      min-width: 200px;
    }
    
    .primary-button:hover {
      background-color: #5C4EAE;
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(108, 95, 188, 0.3);
    }
    
    .primary-button.save-button {
      background-color: #4CAF50; /* –ó–µ–ª—ë–Ω—ã–π –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è */
    }
    
    .primary-button.save-button:hover {
      background-color: #45a049;
      box-shadow: 0 6px 15px rgba(76, 175, 80, 0.3);
    }

    .no-permission-message {
      color: #666;
      font-style: italic;
      padding: 15px;
      text-align: center;
      background-color: #f5f5f5;
      border-radius: 8px;
      border: 1px solid #ddd;
    }

    .secondary-button {
      background-color: #EAEAEA;
      top: -100px;
      color: #333;
      padding: 12px 28px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 500;
      transition: all 0.3s ease;
    }
    
    .secondary-button:hover {
      background-color: #DDD;
      transform: translateY(-2px);
    }

    .buttons-container {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
    }
    
    .danger-button {
      background-color: #dc3545;
      color: white;
      padding: 14px 32px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 500;
      transition: all 0.3s ease;
      min-width: 200px;
    }
    
    .danger-button:hover {
      background-color: #c82333;
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(220, 53, 69, 0.3);
    }
    
    /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —É–¥–∞–ª–µ–Ω–∏—è */
    #deleteConfirmModal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    
    #deleteConfirmModal .modal-content {
      background: #FFFFFF;
      border-radius: 12px;
      width: 500px;
      max-width: 90%;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
    }
    
    #deleteConfirmModal .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 25px 30px;
      border-bottom: 1px solid #EAEAEA;
      background-color: #dc3545;
      border-radius: 12px 12px 0 0;
    }
    
    #deleteConfirmModal .modal-header h3 {
      color: white;
      margin: 0;
      font-size: 22px;
    }
    
    #deleteConfirmModal .modal-close {
      background: none;
      border: none;
      color: white;
      font-size: 28px;
      cursor: pointer;
      padding: 0;
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: background-color 0.3s ease;
    }
    
    #deleteConfirmModal .modal-close:hover {
      background-color: rgba(255, 255, 255, 0.2);
    }
    
    #deleteConfirmModal .modal-body {
      padding: 30px;
    }
    
    #deleteConfirmModal .modal-footer {
      padding: 20px 30px;
      border-top: 1px solid #EAEAEA;
      display: flex;
      justify-content: flex-end;
      gap: 15px;
    }
    
    .warning-message {
      display: flex;
      align-items: flex-start;
      gap: 20px;
    }
    
    .warning-icon {
      font-size: 40px;
      flex-shrink: 0;
    }
    
    .warning-text h4 {
      margin: 0 0 10px 0;
      color: #dc3545;
      font-size: 18px;
    }
    
    .warning-text p {
      margin: 8px 0;
      color: #333;
    }
    
    .warning-text strong {
      color: #dc3545;
      font-size: 17px;
    }
    
    @media (max-width: 768px) {
      .buttons-container {
        flex-direction: column;
      }
      
      .primary-button,
      .danger-button {
        width: 100%;
      }
      
      .warning-message {
        flex-direction: column;
        text-align: center;
      }
    }

    .loading-spinner {
      display: inline-block;
      width: 16px;
      height: 16px;
      border: 2px solid rgba(255,255,255,.3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 1s ease-in-out infinite;
      margin-right: 8px;
      vertical-align: middle;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    /* –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–æ–º –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ */
    body {
      transition: overflow 0.3s ease;
    }
    
    /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
    @media (max-width: 1024px) {
      .content-card {
        padding: 30px;
      }
      
      .form-grid {
        grid-template-columns: 1fr;
        gap: 20px;
      }
    }
    
    @media (max-width: 768px) {
      .page-container {
        padding: 20px 15px;
      }
      
      .content-card {
        padding: 25px 20px;
      }
      
      .profile-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 20px;
      }
      
      .page-title {
        font-size: 28px;
      }
      
      .section-title {
        font-size: 22px;
      }
      
      .navigation-links {
        flex-direction: column;
        gap: 15px;
      }
      
      .info-card {
        flex-direction: column;
        text-align: center;
      }
      
      .info-icon {
        align-self: center;
      }
      
      .detail {
        flex-direction: column;
        align-items: flex-start;
        gap: 5px;
      }
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∑–∞–∫–∞–∑–∞ */

    .order-info-section {
      margin-bottom: 30px;
    }

    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }

    .info-card {
      background: #f9f9f9;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      padding: 20px;
      display: flex;
      gap: 15px;
    }

    .info-icon {
      font-size: 24px;
      margin-top: 5px;
    }

    .info-content {
      flex: 1;
    }

    .info-content h3 {
      margin-top: 0;
      margin-bottom: 15px;
      color: #333;
      font-size: 18px;
    }

    .info-details {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .detail {
      display: flex;
      justify-content: space-between;
      padding-bottom: 8px;
      border-bottom: 1px solid #eee;
    }

    .detail:last-child {
      border-bottom: none;
    }

    .detail-label {
      font-weight: 500;
      color: #666;
      min-width: 120px;
    }

    .detail-value {
      color: #333;
      text-align: right;
      flex: 1;
    }

    /* –°–µ–∫—Ü–∏—è —É—Å–ª—É–≥ */
    .services-section {
      margin-bottom: 30px;
    }

    .cost-summary {
      background: #f5f5f5;
      border-radius: 8px;
      padding: 20px;
      margin-top: 20px;
    }

    .summary-item {
      display: flex;
      justify-content: space-between;
      padding: 10px 0;
      border-bottom: 1px solid #ddd;
    }

    .summary-item:last-child {
      border-bottom: none;
    }

    .summary-item.total {
      font-size: 18px;
      font-weight: 700;
      color: #2e7d32;
    }

    .summary-label {
      color: #666;
    }

    .summary-value {
      font-weight: 500;
    }

    /* –°–µ–∫—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ */
    .documents-section {
      margin-bottom: 30px;
    }

    .section-subtitle {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 15px;
      color: #333;
    }

    .section-description {
      color: #666;
      margin-bottom: 20px;
      font-size: 14px;
    }

    .document-actions {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .document-action {
      text-align: center;
      padding: 25px;
      background: #f9f9f9;
      border: 2px dashed #ddd;
      border-radius: 8px;
      transition: all 0.3s;
    }

    .document-action:hover {
      background: #f0f0f0;
      border-color: #4CAF50;
    }

    .document-action button {
      margin-bottom: 10px;
      width: 100%;
    }

    .document-action button i {
      margin-right: 8px;
    }

    .action-description {
      font-size: 13px;
      color: #666;
      margin: 0;
    }

    /* –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã */
    .existing-documents {
      margin-top: 30px;
    }

    .document-category {
      margin-bottom: 25px;
    }

    .document-category h4 {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 15px;
      color: #444;
      padding-bottom: 8px;
      border-bottom: 2px solid #4CAF50;
    }

    .document-list {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .document-item {
      background: white;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .document-header {
      background: #f8f9fa;
      padding: 15px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid #e0e0e0;
    }

    .document-info {
      flex: 1;
    }

    .document-title {
      font-weight: 600;
      color: #333;
      margin-bottom: 5px;
    }

    .document-date {
      font-size: 13px;
      color: #666;
    }

    .document-status .status-badge {
      padding: 4px 10px;
      font-size: 12px;
    }

    .status-badge.signed {
      background-color: #e8f5e8;
      color: #2e7d32;
    }

    .status-badge.partial {
      background-color: #fff3e0;
      color: #f57c00;
    }

    .status-badge.not-signed {
      background-color: #ffebee;
      color: #d32f2f;
    }

    .document-details {
      padding: 20px;
    }

    .detail-row {
      margin-bottom: 12px;
      display: flex;
    }

    .detail-row .detail-label {
      min-width: 140px;
      font-weight: 500;
      color: #666;
    }

    .detail-row .detail-value {
      flex: 1;
      color: #333;
    }

    .team-members {
      margin: 0;
      padding-left: 20px;
    }

    .team-members li {
      margin-bottom: 5px;
      color: #555;
    }

    .signatures {
      display: flex;
      gap: 30px;
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid #eee;
    }

    .signature-status {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .signature-label {
      font-weight: 500;
      color: #666;
    }

    .signature-value {
      font-weight: 500;
      padding: 4px 8px;
      border-radius: 4px;
    }

    .signature-value.signed {
      background: #e8f5e8;
      color: #2e7d32;
    }

    .signature-value.not-signed {
      background: #ffebee;
      color: #d32f2f;
    }

    .document-actions-row {
      padding: 15px 20px;
      background: #f8f9fa;
      border-top: 1px solid #e0e0e0;
      display: flex;
      gap: 10px;
    }

    /* –§–æ—Ä–º—ã –≤ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–Ω–∞—Ö */
    .form-note {
      background: #f0f7ff;
      border: 1px solid #c5d9f1;
      border-radius: 4px;
      padding: 12px 15px;
      margin-top: 20px;
      font-size: 14px;
      color: #2c3e50;
    }

    .form-note p {
      margin: 0;
    }

    .modal-window {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.7);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      padding: 20px;
      box-sizing: border-box;
      overflow-y: auto;
    }

    .modal-content {
      background: #FFFFFF;
      border-radius: 12px;
      width: 100%;
      max-width: min(800px, 95vw);
      max-height: min(90vh, 800px);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
      animation: modalAppear 0.3s ease-out;
    }

    @keyframes modalAppear {
      from {
        opacity: 0;
        transform: translateY(-20px) scale(0.95);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px;
      border-bottom: 1px solid #EAEAEA;
      background-color: #6C5FBC;
      color: white;
      flex-shrink: 0;
    }

    .modal-header h3 {
      margin: 0;
      font-size: 20px;
      font-weight: 600;
    }

    .modal-close {
      background: rgba(255, 255, 255, 0.2);
      border: none;
      color: white;
      font-size: 24px;
      cursor: pointer;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background-color 0.3s ease;
    }

    .modal-close:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    .modal-body {
      padding: 20px;
      overflow-y: auto;
      flex: 1;
      min-height: 0;
    }

    .modal-footer {
      padding: 20px;
      border-top: 1px solid #EAEAEA;
      display: flex;
      justify-content: flex-end;
      gap: 15px;
      flex-shrink: 0;
    }

    /* –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞ */
    #viewDocumentModal .modal-content {
      max-width: min(90vw, 1200px);
      max-height: min(95vh, 1000px);
    }

    #documentContent {
      width: 100%;
      height: 100%;
      overflow: auto;
      padding: 0;
    }

    /* –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
    @media (max-width: 768px) {
      .modal-window {
        padding: 10px;
      }
    
      .modal-content {
        max-width: 100%;
        max-height: 95vh;
        border-radius: 8px;
      }
    
      .modal-header {
        padding: 15px;
      }
    
      .modal-header h3 {
        font-size: 18px;
      }
    
      .modal-body {
        padding: 15px;
      }
    
      .modal-footer {
        padding: 15px;
        flex-direction: column;
      }
    
      .modal-footer button {
        width: 100%;
      }
    
      .form-group select,
      .form-group input,
      .form-group textarea {
        max-width: 100% !important;
      }
    }

    /* –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —Å—É–∂–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–∞ */
    body.modal-open {
      overflow: hidden;
      padding-right: 15px; /* –ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –¥–ª—è —Å–∫—Ä–æ–ª–ª–±–∞—Ä–∞ */
    }

    /* –î–æ–∫—É–º–µ–Ω—Ç –¥–ª—è –ø–µ—á–∞—Ç–∏ */
    @media print {
      .modal-content {
        box-shadow: none !important;
        border: none !important;
        max-width: 100% !important;
      }
  
      .modal-header, .modal-footer {
        display: none !important;
      }
  
      body {
        margin: 0;
        padding: 20px;
      }
    }
